---
title: "[CS231N] 3. Loss Functions and Optimization"
categories:
  - cs231n
  - Image Classification
tags:
  - cs231
  - image classification
toc: true
toc_sticky: true
toc_label: "On This Page"
toc_icon: "bookmark"
use_math: true
---


💡 Iamge Classification <br>
Stanford University "CS231N" 강의를 듣고 정리하였습니다. <br>
{: .notice--info}


자막 : https://github.com/visionNoob/CS231N_17_KOR_SUB (크롬 확장 프로그램 Subtitles for Youtube) <br>
2017 버전 강의 목차 및 슬라이드 : http://cs231n.stanford.edu/2017/syllabus.html <br>
2017 버전 강의 동영상 링크 : https://www.youtube.com/playlist?list=PL3FW7Lu3i5JvHM8ljYj-zLfQRF3EO8sYv <br>
2022 버전 강의 목차 및 슬라이드 : http://cs231n.stanford.edu/schedule.html <br>
실습 과제 : https://github.com/cs231n/cs231n.github.io/tree/master/assignments <br>
{: .notice}

# Lecture 3 : Loss Functions and Optimization


<img width="556" alt="L3_01" src="https://user-images.githubusercontent.com/86525868/170991223-7e442583-42e4-488c-afe3-eb1b08fe4c7a.png">{: width="40%" height="40%"}{: .align-center}


2강에서는 가중치 행렬 $W$의 각 행들이 해당하는 플래스의 템플릿이 되고 행렬 $W$의 각 행은 **이미지의 픽셀 값**과 **해당 클래스**사이의 가중치가 되고 이것을 통해 각 이미지에 해당하는 10개의 클래스 스코어를 계산

이 클래스 스코어를 가지고 이미지를 분류하는 것은 좋은 방법이 아님 (개구리 이미지의 경우 개구리 클래스 점수가 $-4.34$ )

어떤 행렬 $W$가 가장 좋은 점수를 내는지 **정량화**할 필요가 있음 → 행렬 $W$를 입력으로 받아서 각 스코어를 확인하고 얼마나 좋고 나쁜지 정략적으로 말해주는 것이 **손실함수**


<img width="680" alt="L3_02" src="https://user-images.githubusercontent.com/86525868/170991244-8b0297f0-6d19-4cfb-b352-931a5b3946d8.png">{: width="30%" height="30%"}{: .align-center}

트레이닝 데이터 $X$는 알고리즘의 입력값인 이미지이고 $Y$는 예측하고자 하는 값인 레이블(타켓)로 카테고리의 갯수 사이의 정수 값이 됨 

다음으로 예측함수 $f$ 와 정답 값  $Y$를 입력받아 얼마나 예측을 못하는지 정량화 하는 손실함수 $L_i$를 정의 → 평균내면 최종 loss인 $L$

$$
L=\frac{1}{N}\sum_i L_i(f(x_i, W), y_i)
$$

<br>

## Multi-class SVM

Image Classification에 적합한 손실함수 

$$
\begin{align}
L_i &=& &\sum_{j\ne y_i}\begin{cases}0 &\mbox if s_{y_i} \geq s_j +1 \\ 
				s_i-s_{y_i} +1 &\mbox otherwise\end{cases}\\
&=& &\sum_{j \ne y_i} max(0, s_j-s_{y_i}+1)
\end{align}\\
$$

$L_i$ 구하는 방법 

1. True인 카테고리를 제외한 나머지 카테고리 $Y$ 즉, 맞지 않는 카테고리 전부 합침
2. 올바른 카테고리의 스코어와 올바르지 않은 카테고리의 스코어 비교   

  * 올바른 카테고리의 점수가 올바르지 않은 카테고리의 점수+margin($S_j+1$)보다 높으면 True인 스코어가 다른 False 카테고리보다 훨씬 더 크다는 것을 의미 → **Loss는 0이 됨**

3. 0과 다른 값의 최댓값 $Max(0, value)$의 식으로 손실함수를 만듦

<img width="457" alt="L3_03" src="https://user-images.githubusercontent.com/86525868/170991251-9d70c202-08cc-43eb-85fa-693bf39dd602.png">{: width="30%" height="30%"}{: .align-center}

이러한 손실함수를 **Hinge loss** 

* 정답 카테고리의 점수가 올라갈수록 Loss가 선형적으로 줄어듦 → Loss가 0이라는 건 클래스를 잘 분류한 것

<img width="668" alt="L3_04" src="https://user-images.githubusercontent.com/86525868/170991239-1d6c6c3b-92e9-4be8-8fa2-9e1bffcd559e.png">{: width="30%" height="30%"}{: .align-center}

$L_{cat}=max(0, 5.1-3.2+1)+max(0,-1.7-3.2+1)=2.9+0=2.9$

$L_{car}=max(0, 1.3-4.9+1)+max(0,2.0-4.9+1)=0+0=0$

$L_{frog}=max(0, 2.2+3.1+1)+max(0,2.5+3.1+1)=6.3+6.6=12.9$


$$
\begin{align}
L &=&  & \frac{1}{N}\sum_{i=1}^N L_i \\
&=& & (2.9+0.0+12.9)/3=5.27
\end{align}
$$


분류기가 5.27 만큼 이 트레이닝 셋을 안 좋게 분류하고 있다는 **정량적 지표**

