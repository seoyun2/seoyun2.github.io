<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.20.2 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>[CS231N] 3. Loss Functions and Optimization - ì •ë¦¬ì™•ì´ ë˜ê³ ì‹¶ì€ ì„œìœ¤ì”¨ì˜ BLOG</title>
<meta name="description" content="ğŸ’¡ Iamge Classification  Stanford University â€œCS231Nâ€ ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.">


  <meta name="author" content="Seoyun Lee">
  
  <meta property="article:author" content="Seoyun Lee">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="ì •ë¦¬ì™•ì´ ë˜ê³ ì‹¶ì€ ì„œìœ¤ì”¨ì˜ BLOG">
<meta property="og:title" content="[CS231N] 3. Loss Functions and Optimization">
<meta property="og:url" content="http://localhost:4000/cs231n/cs231n-02/">


  <meta property="og:description" content="ğŸ’¡ Iamge Classification  Stanford University â€œCS231Nâ€ ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.">







  <meta property="article:published_time" content="2022-05-30T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/cs231n/cs231n-02/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "ì´ì„œìœ¤(Seoyun Lee)",
      "url": "http://localhost:4000/"
    
  }
</script>


  <meta name="google-site-verification" content="google32f284dcb09e1f6f.html" />





<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="ì •ë¦¬ì™•ì´ ë˜ê³ ì‹¶ì€ ì„œìœ¤ì”¨ì˜ BLOG Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          ì •ë¦¬ì™• ì„œìœ¤ì”¨
          <span class="site-subtitle">Bachelor of Science in Applied statistics</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/">Category</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">Year</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">í† ê¸€ ë©”ë‰´</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/bio-photo.jpg" alt="Seoyun Lee" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Seoyun Lee</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>ë§¤ì¼ <strong>ê³µë¶€</strong>í•˜ê³  ë§¤ì¼ <strong>ì •ë¦¬</strong>í•˜ê¸°</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">íŒ”ë¡œìš°</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Republic of Korea</span>
        </li>
      

      
        
          
            <li><a href="mailto:96seoyun@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://github.com/seoyun2" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
          
            <li><a href="https://www.instagram.com/seoyun._2/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  

  
    <!--ì „ì²´ ê¸€ ìˆ˜ë¥¼ ì„¸ê¸° ìœ„í•œ ì—°ì‚°. sum ë³€ìˆ˜ì— ì „ì²´ ê¸€ ìˆ˜ ì €ì¥-->



<nav class="nav__list">
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">í† ê¸€ ë©”ë‰´</label>
  <ul class="nav__items" id="category_tag_menu">
      <!--ì „ì²´ ê¸€ ìˆ˜-->
      <li>
            ğŸ“‚ <span style="font-family:'Cafe24Oneprettynight';">ì „ì²´ ê¸€ ìˆ˜</style> <span style="font-family:'Coming Soon';">25</style> <span style="font-family:'Cafe24Oneprettynight';">ê°œ</style> 
      </li>
      <li>
        <!--span íƒœê·¸ë¡œ ì¹´í…Œê³ ë¦¬ë“¤ì„ í¬ê²Œ ë¶„ë¥˜ ex) C/C++/C#-->
        <span class="nav__sub-title">ë°ì´í„° ë¶„ì„</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” í˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” í˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/da" class="">Data Analysis (6)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/ds" class="">Data Science (5)</a></li>
                    
                
                    
                
            </ul>
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">Coding Test</span>
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/hackerrank" class="">Hacker Rank SQL(1)</a></li>
                    
                
            </ul>
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <span class="nav__sub-title">ETC</span>
            <ul>
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/cs231n" class="">CS231N (5)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
      </li>
  </ul>
</nav>
  

  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="[CS231N] 3. Loss Functions and Optimization">
    <meta itemprop="description" content="ğŸ’¡ Iamge Classification Stanford University â€œCS231Nâ€ ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤. ">
    <meta itemprop="datePublished" content="2022-05-30T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">[CS231N] 3. Loss Functions and Optimization
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          7 ë¶„ ì†Œìš”
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-bookmark"></i> On This Page</h4></header>
              <ul class="toc__menu">
  <li><a href="#lecture-3--loss-functions-and-optimization">Lecture 3 : Loss Functions and Optimization</a>
      - {:.} <a href="#multi-class-svm">Multi-class SVM</a>
    <ul>
      <li><a href="#regularization">Regularization</a>
        <ul>
          <li><a href="#in-common-use-regularizations">In common use Regularizations</a></li>
        </ul>
      </li>
      <li><a href="#softmax-classifier-multinomial-logistic-regression">Softmax Classifier (Multinomial Logistic Regression)</a></li>
      <li><a href="#svm-loss-vs-softmax-loss">SVM Loss vs Softmax Loss</a></li>
      <li><a href="#optimization">Optimization</a>
        <ul>
          <li><a href="#strategy-1--random-searchì„ì˜-íƒìƒ‰">Strategy #1 : Random Search(ì„ì˜ íƒìƒ‰)</a></li>
          <li><a href="#strategy-2--follow-the-slope">Strategy #2 : Follow the slope</a></li>
          <li><a href="#gradient-descent">Gradient Descent</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

            </nav>
          </aside>
        
        <p class="notice--info">ğŸ’¡ Iamge Classification <br />
Stanford University â€œCS231Nâ€ ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤. <br /></p>

<p class="notice">ìë§‰ : https://github.com/visionNoob/CS231N_17_KOR_SUB (í¬ë¡¬ í™•ì¥ í”„ë¡œê·¸ë¨ Subtitles for Youtube) <br />
2017 ë²„ì „ ê°•ì˜ ëª©ì°¨ ë° ìŠ¬ë¼ì´ë“œ : http://cs231n.stanford.edu/2017/syllabus.html <br />
2017 ë²„ì „ ê°•ì˜ ë™ì˜ìƒ ë§í¬ : https://www.youtube.com/playlist?list=PL3FW7Lu3i5JvHM8ljYj-zLfQRF3EO8sYv <br />
2022 ë²„ì „ ê°•ì˜ ëª©ì°¨ ë° ìŠ¬ë¼ì´ë“œ : http://cs231n.stanford.edu/schedule.html <br />
ì‹¤ìŠµ ê³¼ì œ : https://github.com/cs231n/cs231n.github.io/tree/master/assignments <br /></p>

<h1 id="lecture-3--loss-functions-and-optimization">Lecture 3 : Loss Functions and Optimization</h1>

<p><img width="40%" alt="L3_01" src="https://user-images.githubusercontent.com/86525868/170991223-7e442583-42e4-488c-afe3-eb1b08fe4c7a.png" height="40%" class="align-center" /></p>

<p>2ê°•ì—ì„œëŠ” ê°€ì¤‘ì¹˜ í–‰ë ¬ $W$ì˜ ê° í–‰ë“¤ì´ í•´ë‹¹í•˜ëŠ” í”Œë˜ìŠ¤ì˜ í…œí”Œë¦¿ì´ ë˜ê³  í–‰ë ¬ $W$ì˜ ê° í–‰ì€ <strong>ì´ë¯¸ì§€ì˜ í”½ì…€ ê°’</strong>ê³¼ <strong>í•´ë‹¹ í´ë˜ìŠ¤</strong>ì‚¬ì´ì˜ ê°€ì¤‘ì¹˜ê°€ ë˜ê³  ì´ê²ƒì„ í†µí•´ ê° ì´ë¯¸ì§€ì— í•´ë‹¹í•˜ëŠ” 10ê°œì˜ í´ë˜ìŠ¤ ìŠ¤ì½”ì–´ë¥¼ ê³„ì‚°</p>

<p>ì´ í´ë˜ìŠ¤ ìŠ¤ì½”ì–´ë¥¼ ê°€ì§€ê³  ì´ë¯¸ì§€ë¥¼ ë¶„ë¥˜í•˜ëŠ” ê²ƒì€ ì¢‹ì€ ë°©ë²•ì´ ì•„ë‹˜ (ê°œêµ¬ë¦¬ ì´ë¯¸ì§€ì˜ ê²½ìš° ê°œêµ¬ë¦¬ í´ë˜ìŠ¤ ì ìˆ˜ê°€ $-4.34$ )</p>

<p>ì–´ë–¤ í–‰ë ¬ $W$ê°€ ê°€ì¥ ì¢‹ì€ ì ìˆ˜ë¥¼ ë‚´ëŠ”ì§€ <strong>ì •ëŸ‰í™”</strong>í•  í•„ìš”ê°€ ìˆìŒ â†’ í–‰ë ¬ $W$ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ì„œ ê° ìŠ¤ì½”ì–´ë¥¼ í™•ì¸í•˜ê³  ì–¼ë§ˆë‚˜ ì¢‹ê³  ë‚˜ìœì§€ ì •ëµì ìœ¼ë¡œ ë§í•´ì£¼ëŠ” ê²ƒì´ <strong>ì†ì‹¤í•¨ìˆ˜</strong></p>

<p><img width="30%" alt="L3_02" src="https://user-images.githubusercontent.com/86525868/170991244-8b0297f0-6d19-4cfb-b352-931a5b3946d8.png" height="30%" class="align-center" /></p>

<p>íŠ¸ë ˆì´ë‹ ë°ì´í„° $X$ëŠ” ì•Œê³ ë¦¬ì¦˜ì˜ ì…ë ¥ê°’ì¸ ì´ë¯¸ì§€ì´ê³  $Y$ëŠ” ì˜ˆì¸¡í•˜ê³ ì í•˜ëŠ” ê°’ì¸ ë ˆì´ë¸”(íƒ€ì¼“)ë¡œ ì¹´í…Œê³ ë¦¬ì˜ ê°¯ìˆ˜ ì‚¬ì´ì˜ ì •ìˆ˜ ê°’ì´ ë¨</p>

<p>ë‹¤ìŒìœ¼ë¡œ ì˜ˆì¸¡í•¨ìˆ˜ $f$ ì™€ ì •ë‹µ ê°’  $Y$ë¥¼ ì…ë ¥ë°›ì•„ ì–¼ë§ˆë‚˜ ì˜ˆì¸¡ì„ ëª»í•˜ëŠ”ì§€ ì •ëŸ‰í™” í•˜ëŠ” ì†ì‹¤í•¨ìˆ˜ $L_i$ë¥¼ ì •ì˜ â†’ í‰ê· ë‚´ë©´ ìµœì¢… lossì¸ $L$</p>

\[L=\frac{1}{N}\sum_i L_i(f(x_i, W), y_i)\]

<p><br /></p>

<h3 id="multi-class-svm">Multi-class SVM</h3>

<p>Image Classificationì— ì í•©í•œ ì†ì‹¤í•¨ìˆ˜</p>

\[\begin{align}
L_i &amp;=&amp; &amp;\sum_{j\ne y_i}\begin{cases}0 &amp;\mbox if s_{y_i} \geq s_j +1 \\ 
				s_i-s_{y_i} +1 &amp;\mbox otherwise\end{cases}\\
&amp;=&amp; &amp;\sum_{j \ne y_i} max(0, s_j-s_{y_i}+1)
\end{align}\\\]

<p>$L_i$ êµ¬í•˜ëŠ” ë°©ë²•</p>

<ol>
  <li>Trueì¸ ì¹´í…Œê³ ë¦¬ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ì¹´í…Œê³ ë¦¬ $Y$ ì¦‰, ë§ì§€ ì•ŠëŠ” ì¹´í…Œê³ ë¦¬ ì „ë¶€ í•©ì¹¨</li>
  <li>ì˜¬ë°”ë¥¸ ì¹´í…Œê³ ë¦¬ì˜ ìŠ¤ì½”ì–´ì™€ ì˜¬ë°”ë¥´ì§€ ì•Šì€ ì¹´í…Œê³ ë¦¬ì˜ ìŠ¤ì½”ì–´ ë¹„êµ</li>
</ol>

<ul>
  <li>ì˜¬ë°”ë¥¸ ì¹´í…Œê³ ë¦¬ì˜ ì ìˆ˜ê°€ ì˜¬ë°”ë¥´ì§€ ì•Šì€ ì¹´í…Œê³ ë¦¬ì˜ ì ìˆ˜+margin($S_j+1$)ë³´ë‹¤ ë†’ìœ¼ë©´ Trueì¸ ìŠ¤ì½”ì–´ê°€ ë‹¤ë¥¸ False ì¹´í…Œê³ ë¦¬ë³´ë‹¤ í›¨ì”¬ ë” í¬ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸ â†’ <strong>LossëŠ” 0ì´ ë¨</strong></li>
</ul>

<ol>
  <li>0ê³¼ ë‹¤ë¥¸ ê°’ì˜ ìµœëŒ“ê°’ $Max(0, value)$ì˜ ì‹ìœ¼ë¡œ ì†ì‹¤í•¨ìˆ˜ë¥¼ ë§Œë“¦</li>
</ol>

<p><img width="30%" alt="L3_03" src="https://user-images.githubusercontent.com/86525868/170991251-9d70c202-08cc-43eb-85fa-693bf39dd602.png" height="30%" class="align-center" /></p>

<p>ì´ëŸ¬í•œ ì†ì‹¤í•¨ìˆ˜ë¥¼ <strong>Hinge loss</strong></p>

<ul>
  <li>ì •ë‹µ ì¹´í…Œê³ ë¦¬ì˜ ì ìˆ˜ê°€ ì˜¬ë¼ê°ˆìˆ˜ë¡ Lossê°€ ì„ í˜•ì ìœ¼ë¡œ ì¤„ì–´ë“¦ â†’ Lossê°€ 0ì´ë¼ëŠ” ê±´ í´ë˜ìŠ¤ë¥¼ ì˜ ë¶„ë¥˜í•œ ê²ƒ</li>
</ul>

<p><img width="30%" alt="L3_04" src="https://user-images.githubusercontent.com/86525868/170991239-1d6c6c3b-92e9-4be8-8fa2-9e1bffcd559e.png" height="30%" class="align-center" /></p>

<p>$L_{cat}=max(0, 5.1-3.2+1)+max(0,-1.7-3.2+1)=2.9+0=2.9$</p>

<p>$L_{car}=max(0, 1.3-4.9+1)+max(0,2.0-4.9+1)=0+0=0$</p>

<p>$L_{frog}=max(0, 2.2+3.1+1)+max(0,2.5+3.1+1)=6.3+6.6=12.9$</p>

\[\begin{align}
L &amp;=&amp;  &amp; \frac{1}{N}\sum_{i=1}^N L_i \\
&amp;=&amp; &amp; (2.9+0.0+12.9)/3=5.27
\end{align}\]

<p>ë¶„ë¥˜ê¸°ê°€ 5.27 ë§Œí¼ ì´ íŠ¸ë ˆì´ë‹ ì…‹ì„ ì•ˆ ì¢‹ê²Œ ë¶„ë¥˜í•˜ê³  ìˆë‹¤ëŠ” <strong>ì •ëŸ‰ì  ì§€í‘œ</strong> <br /></p>

<p><strong>Question</strong> : SVM Lossê°€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ìµœëŒ“ê°’ê³¼ ìµœì†Ÿê°’ì€</p>

<ul>
  <li>ì†ì‹¤í•¨ìˆ˜ê°€ Hinge Loss ëª¨ì–‘ì´ë¼ëŠ” ê²ƒì„ ìƒê°í•´ ë³´ë©´ $\infty$, 0 <br /></li>
</ul>

<p><strong>Question</strong> : íŒŒë¼ë¯¸í„°ë¥¼ ì´ˆê¸°í™”í•˜ê³  ì²˜ìŒë¶€í„° í•™ìŠµì‹œí‚¬ ë•Œ, ë³´í†µ í–‰ë ¬ $W$ë¥¼ ì„ì˜ì˜ ì‘ì€ ìˆ˜ë¡œ ì´ˆê¸°í™” í•˜ëŠ”ë° ê·¸ë ‡ê²Œ ë˜ë©´ ì²˜ìŒ í•™ìŠµì‹œì—ëŠ” ê²°ê³¼ ìŠ¤ì½”ì–´ê°€ ì„ì˜ì˜ ì¼ì •í•œ ê°’ì„ ê°–ê²Œ ë¨. ë§Œì•½ ëª¨ë“  ìŠ¤ì½”ì–´ $S$ê°€ ê±°ì˜ 0ì— ê°€ê¹ê³  ê°’ì´ ì„œë¡œ ë¹„ìŠ·í•˜ë‹¤ë©´ Lossê°€ ì–´ë–»ê²Œ ë ê¹Œ</p>

<ul>
  <li>Lossë¥¼ ê³„ì‚°í•  ë•Œ ì •ë‹µì´ ì•„ë‹Œ í´ë˜ìŠ¤ë¥¼ ìˆœíšŒí•˜ê¸° ë•Œë¬¸ì— $C-1$ í´ë˜ìŠ¤ë¥¼ ìˆœíšŒí•˜ê²Œ ë˜ê³  ë¹„êµí•˜ëŠ” ë‘ ìŠ¤ì½”ì–´ê°€ ë¹„ìŠ·í•˜ë‹ˆ Margin ë•Œë¬¸ì— 1ì´ë¼ëŠ” ê°’ì„ ì–»ê²Œ ë¨</li>
</ul>

<p>â†’ íŠ¸ë ˆì´ë‹ì„ ì²˜ìŒ ì‹œì‘í• ë•Œ Lossê°€ $C-1$ì´ ì•„ë‹ˆë¼ë©´ <strong>ë””ë²„ê¹… ë¬¸ì œ</strong>ê°€ ìˆë‹¤ëŠ” ê±¸ ì˜ë¯¸ <br /></p>

<p><strong>Question</strong> : ì†ì‹¤ í•¨ìˆ˜ê°€ $\sum_{j \ne y_i} max(0, s_j-s_{y_i}+1)$ê°€ ì•„ë‹Œ $\sum_{j \ne y_i} max(0, s_j-s_{y_i}+1)^2$ì´ë¼ë©´ ì–´ë–»ê²Œ ë ê¹Œ</p>

<ul>
  <li>Hinge LossëŠ” ì¡°ê¸ˆ ì˜ëª»ëœ ì—ëŸ¬ì™€ ë§ì´ ì˜ëª»ëœ ì—ëŸ¬ë¥¼ í¬ê²Œ ì‹ ê²½ ì“°ì§€ ì•Šì§€ë§Œ Squared Hinge LossëŠ” ì—ëŸ¬ì˜ ê°’ë„ ì œê³±ì´ ë˜ê¸° ë•Œë¬¸ì— ì—ëŸ¬ë„ ê³±ì ˆë¡œ ì •ëŸ‰í™” í•  ìˆ˜ ìˆìŒ</li>
  <li>ì†ì‹¤í•¨ìˆ˜ë¥¼ ë§Œë“¤ ë•Œ ì–´ë–¤ ì—ëŸ¬ë¥¼ ì‹ ê²½ì“°ëŠ”ì§€, ì–´ë–¤ ì—ëŸ¬ê°€ íŠ¸ë ˆì´ë“œ ì˜¤í”„ ë˜ëŠ” ê²ƒì¸ì§€ì— ë”°ë¼ ì†ì‹¤í•¨ìˆ˜ë¥¼ ì„¤ê³„í•´ì•¼í•¨</li>
</ul>

<h2 id="regularization">Regularization</h2>

<p><img src="https://user-images.githubusercontent.com/86525868/171036604-0c479197-336e-4e2a-992f-a85146cab732.png" alt="L3_05" /></p>

<ol>
  <li>íŠ¸ë ˆì´ë‹ ì…‹(íŒŒë€ìƒ‰ ì )ì— ë§ì¶˜ ë¶„ë¥˜ê¸°(íŒŒë€ìƒ‰ ì„ )</li>
  <li>
    <p>ìƒˆë¡œ ë“¤ì–´ì˜¨ í…ŒìŠ¤íŠ¸ ì…‹(ë…¹ìƒ‰ ë„¤ëª¨) â†’ <strong>íŠ¸ë ˆì´ë‹ ì…‹ì— ë§ì¶˜ ë¶„ë¥˜ê¸°ì—ë§Œ ë§ì¶˜ ë¶„ë¥˜ê¸°ëŠ” í…ŒìŠ¤íŠ¸ ì…‹ì„ ë§ì¶”ì§€ ëª»í•¨</strong></p>
  </li>
  <li>ìš°ë¦¬ê°€ ì˜ë„í•œ ê±´ ë…¹ìƒ‰ ì„  â†’ <strong>íŠ¸ë ˆì´ë‹ ì…‹ì„ ì˜ ë§ì¶”ì§€ ëª»í•˜ë”ë¼ë„ í…ŒìŠ¤íŠ¸ ì…‹ì—ì„œì˜ ë†’ì€ ì„±ëŠ¥ì„ ë³´ì´ëŠ” ë¶„ë¥˜ê¸°</strong></li>
</ol>

<p>ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²•ì´ <strong>Regularization</strong></p>

<p><img width="50%" alt="L3_06" src="https://user-images.githubusercontent.com/86525868/171037052-7a41fb79-06f0-436f-9e0b-6e1da3a269d8.png" height="50%" class="align-center" /></p>

<p>Data Loss Termì—ì„œëŠ” ë¶„ë¥˜ê¸°ê°€ íŠ¸ë ˆì´ë‹ ë°ì´í„°ì— fití•˜ê²Œ í•˜ê³  Loss Functionì—ì„œ Regularizationì„ ì¶”ê°€í•´ ëª¨ë¸ì´ ì¢€ ë” <strong>ë‹¨ìˆœí•œ W</strong>ë¥¼ ì°¾ë„ë¡ ë„ì™€ì¤Œ <br /></p>

<p>Regularizationì˜ ì—­í• </p>

<ol>
  <li>ëª¨ë¸ì´ ë” ë³µì¡í•´ì§€ì§€ ëª»í•˜ê²Œ í•˜ê±°ë‚˜</li>
  <li>
    <p>ëª¨ë¸ì€ ì—¬ì „íˆ ë³µì¡í•˜ì§€ë§Œ sort penaltyë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ (ë³µì¡í•œ ëª¨ë¸ì„ ê³„ì† ì“°ê³ ì‹¶ìœ¼ë©´ penaltyë¥¼ ê°ìˆ˜í•´ì•¼ í•¨ì„ ì˜ë¯¸) <br /></p>

    <p><strong>ëª¨ë¸ì´ íŠ¸ë ˆì´ë‹ ë°ì´í„° ì…‹ì— ì™„ë²½íˆ fitë˜ì§€ ì•Šë„ë¡ penaltyë¥¼ ë¶€ì—¬</strong></p>
  </li>
</ol>

<p><strong>ì˜¤ì»´ì˜ ë©´ë„ë‚ (Occamâ€™s Razor)</strong> : Among competing hypotheses, the simplest is the best</p>

<ul>
  <li>ë” ì¼ë°˜ì ì¸ (ë” ë‹¨ìˆœí•œ) ê²ƒì´ ë¯¸ë˜ì— ì¼ì–´ë‚  í˜„ìƒì„ ì˜ ì„¤ëª…í•  ê°€ëŠ¥ì„±ì´ ë†’ê¸° ë•Œë¬¸</li>
</ul>

<h3 id="in-common-use-regularizations">In common use Regularizations</h3>

\[L=\frac{1}{N}\sum_{i=1}^N\sum_{j\ne y_i}max(0, f(x_i;W)_j-f(X_i;W)y_i+1)+\lambda R(W)\]

<ol>
  <li>
    <p>L2 Regularization : $R(W)=\sum_k\sum_lW_{k,l}^2$</p>

    <ul>
      <li>ê°€ì¤‘ì¹˜ í–‰ë ¬ $W$ì— penaltyë¥¼ ë¶€ì—¬</li>
    </ul>
  </li>
  <li>
    <p>L1 Regularization : $R(W)=\sum_k\sum_l|W_{k,l}|$</p>

    <ul>
      <li>í–‰ë ¬ $W$ê°€ í¬ì†Œí–‰ë ¬(í–‰ë ¬ì˜ ê°’ì´ ëŒ€ë¶€ë¶„ 0ì¸ í–‰ë ¬)</li>
    </ul>
  </li>
  <li>
    <p>Elastic net (L1+L2) : $R(W)=\sum_k\sum_l\beta W_{k,l}^2+|W_{k,l}|$ <br /></p>
  </li>
</ol>

<p><strong>ì˜ˆì‹œ</strong> $x=[1\ 1\ 1\ 1], w_1=[1 \ 0 \ 0 \ 0], w_2=[0.25 \ 0.25 \ 0.25 \ 0.25]$</p>

<ul>
  <li>
    <p>Linear Regressionì€ $x$ì™€ì˜ ë‚´ì ì´ ì„œë¡œ ê°™ê¸° ë•Œë¬¸ì— $w_1, w_2$ëŠ” ê°™ìŒ</p>
  </li>
  <li>
    <p>L2 Regresstionì—ì„œëŠ” ì–´ë–¤ê²ƒì´ ë” ì¡°ì¡í•œì§€(ë§¤ë„ëŸ¬ì›Œì•¼í•¨)ì— ë”°ë¼ ê²°ì •ë˜ê¸° ë•Œë¬¸ì— $w_2$ê°€ normì´ ì‘ê¸° ë•Œë¬¸ì— $w_2$ë¥¼ ì„ í˜¸ â†’ $x$ì˜ ëª¨ë“  ìš”ì†Œê°€ ì˜í–¥ì„ ë¼ì¹˜ê¸¸ ë°”ëŒ</p>
  </li>
  <li>
    <p>L1 Regresstionì€ í–‰ë ¬ $w$ì— 0ì˜ ê°¯ìˆ˜ì— ë”°ë¼ ë³µì¡ë„ê°€ ê²°ì •ë˜ê¸° ë•Œë¬¸ì— $w_1$ë¥¼ ì„ í˜¸</p>
  </li>
</ul>

<h2 id="softmax-classifier-multinomial-logistic-regression"><strong>Softmax Classifier</strong> (Multinomial Logistic Regression)</h2>

<p>Multi-class SVMì—ì„œëŠ” ìŠ¤ì½”ì–´ ìì²´ë¥¼ ì‹ ê²½ ì“°ì§€ ì•Šì•˜ì§€ë§Œ Multinomial Logistic Regressionì—ì„œëŠ” ìŠ¤ì½”ì–´ ìì²´ì— ì¶”ê°€ì ì¸ ì˜ë¯¸ë¥¼ ë¶€ì—¬í•¨</p>

<p>socoreì€ í´ë˜ìŠ¤ì˜ ì •ê·œí™” ë˜ì§€ ì•Šì€ ë¡œê·¸í™•ë¥ ì„ ì˜ë¯¸í•˜ê³  ìˆ˜ì‹ì„ ì´ìš©í•´ì„œ ìŠ¤ì½”ì–´ë¥¼ í†µí•´ í´ë˜ìŠ¤ ë³„ í™•ë¥  ë¶„í¬ë¥¼ ê³„ì‚°í•¨<br /></p>

\[P(Y=k|X=x_i)=\frac{e^{s_k}}{\sum_j e^{s_j}}\quad \text{where}\quad s=f(x_i;W)\\
\\
L_i=-\log P(Y=y_i|X=x_i)\\ \\
\text{in summary : } \quad L_i=-\log (\frac{e^{s_{y_i}}}{\sum_j e^{s_j}})\]

<ul>
  <li>ìŠ¤ì½”ì–´ ì „ë¶€ë¥¼ ì§€ìˆ˜ë¥¼ ì·¨í•´ì„œ ì–‘ìˆ˜ê°€ ë˜ê³  ë§Œë“¤ê³  $\sum$ìœ¼ë¡œ ë‹¤ì‹œ ì •ê·œí™” ì‹œí‚´</li>
  <li>softmaxì—ì„œ ë‚˜ì˜¨ í™•ë¥ ì´ ì •ë‹µ í´ë˜ìŠ¤ì— í•´ë‹¹í•˜ëŠ” í´ë˜ìŠ¤ì˜ í™•ë¥ , ì¦‰ 1ë¡œ ë‚˜íƒ€ë‚˜ê²Œ í•˜ê³  ì‹¶ê¸° ë•Œë¬¸ì— $Loss$ëŠ”$\log(\text{probability of the true class})$ â†’ ì†ì‹¤ í•¨ìˆ˜ëŠ” ì–¼ë§ˆë‚˜ ì˜ ëª» ë§ì¶”ëŠ”ì§€ë¥¼ ì¸¡ì •í•˜ëŠ” í•¨ìˆ˜ì´ê¸° ë•Œë¬¸ì— ë§ˆì´ë„ˆìŠ¤ë¥¼ ë¶™ì„</li>
  <li>softmax í•¨ìˆ˜ë¥¼ ê±°ì¹˜ë©´ í•´ë‹¹ í´ë˜ìŠ¤ì˜ í™•ë¥  ë¶„í¬ë¥¼ ì–»ì„ ìˆ˜ ìˆìŒ</li>
</ul>

<p><img src="https://user-images.githubusercontent.com/86525868/171036603-b7d345ad-30bb-4a23-97b3-b17d684b6bf5.png" alt="L3_07" /></p>

<p><strong>ê³¼ì •</strong> : ìŠ¤ì½”ì–´ â†’ ì§€ìˆ˜í™” â†’ (í•©ì´ 1ì´ ë˜ë„ë¡) ì •ê·œí™” â†’ ì •ë‹µ ìŠ¤ì½”ì–´ì—ë§Œ $-\log$ë¥¼ ì”Œì›€</p>

<p><strong>Question</strong> : Softmax Lossì˜ ìµœëŒ“ê°’ê³¼ ìµœì†Ÿê°’ì€</p>

<ul>
  <li>í™•ë¥  ë¶„í¬ë¥¼ ìƒê°í•´ ë³´ë©´ ì •ë‹µ í´ë˜ìŠ¤ì˜ í™•ë¥ ì€ 1ì´ ë˜ê¸¸ ì›í•˜ê³  ì •ë‹µì´ ì•„ë‹Œ í´ë˜ìŠ¤ëŠ” 0ì´ ë˜ê¸¸ ì›í•¨. ì •ë‹µ í´ë˜ìŠ¤ì— ëŒ€í•œ $\log$í™•ë¥ ì´ê¸° ë•Œë¬¸ì— $\log(1)=0, -\log(1)=0$ â†’ ê³ ì–‘ì´ë¥¼ ì™„ë²½í•˜ê²Œ ë¶„ë¥˜í–ˆë‹¤ë©´ LossëŠ” 0ì´ ë¨</li>
  <li>Lossê°€ 0ì´ ë˜ë ¤ë©´ ì‹¤ì œ ìŠ¤ì½”ì–´ëŠ” ë¬´í•œëŒ€ì— ê°€ê¹ê²Œ ë†’ì•„ì•¼í•˜ê³  ì§€ìˆ˜í™”ì™€ ì •ê·œí™”ë¥¼ í•˜ê¸° ë•Œë¬¸ì— í™•ë¥  1(ì •ë‹µ), 0(ê·¸ì™¸)ë¥¼ ì–»ìœ¼ë ¤ë©´ ì •ë‹µ í´ë˜ìŠ¤ì˜ ìŠ¤ì½”ì–´ëŠ” $+\infty$, ë‚˜ë¨¸ì§€ëŠ” $-\infty$ì´ ë˜ì–´ì•¼ í•¨</li>
  <li>ìµœëŒ“ê°’ì€ ì—†ìŒ <br /></li>
</ul>

<p><strong>Question</strong> : SVM Lossì™€ ë§ˆì°¬ê°€ì§€ë¡œ $s$ê°€ ëª¨ë‘ 0 ê·¼ì²˜ì— ëª¨ì—¬ìˆëŠ” ì‘ì€ ìˆ˜ì¼ë•Œì˜ LossëŠ”</p>

<ul>
  <li>$-\log(\frac{1}{C}=\log(C))$ â†’ ë§ˆì°¬ê°€ì§€ë¡œ ì´ˆê¸°ì— $\log(C)$ê°€ ì•„ë‹ˆë¼ë©´ ë””ë²„ê¹… ë¬¸ì œê°€ ìˆë‹¤ëŠ” ê±¸ ì˜ë¯¸</li>
</ul>

<h2 id="svm-loss-vs-softmax-loss">SVM Loss vs Softmax Loss</h2>

<p><img width="1130" alt="L3_08" src="https://user-images.githubusercontent.com/86525868/171037152-9b7ded56-25ed-4b6d-a4a9-a230ae280f42.png" /></p>

<ul>
  <li><strong>SVM Loss</strong> : ì •ë‹µ ìŠ¤ì½”ì–´, ì •ë‹µì´ ì•„ë‹Œ ìŠ¤ì½”ì–´ ê°„ì˜ marginì— ì§‘ì¤‘</li>
  <li>
    <p><strong>Softmax Loss</strong> : í™•ë¥ ì„ êµ¬í•´ì„œ $-\log(\text{probability of the true class})$ì— ì§‘ì¤‘</p>
  </li>
  <li>Multi-class SVM Lossì€ ì•ì— ì˜ˆì‹œì—ì„œ car í´ë˜ìŠ¤ì—ì„œ car scoreê°€ ë‹¤ë¥¸ í´ë˜ìŠ¤ë³´ë‹¤ í›¨ì”¬ ë†’ì•˜ê³  ê·¸ë ‡ê¸° ë•Œë¬¸ì— car scoreë¥¼ ì¡°ê¸ˆ ë†’ì¸í•˜ê³ í•´ì„œ SVM Lossê°€ ë³€í•˜ì§„ ì•ŠìŒ(SVM LossëŠ” ì˜¤ì§ ì •ë‹µê³¼ ê·¸ ì™¸ í´ë˜ìŠ¤ì˜ ë§ˆì§„ì´ ì–¼ë§ˆë‚˜ ë˜ëŠ”ì§€ì—ë§Œ ê´€ì‹¬ì´ ìˆê¸° ë•Œë¬¸)</li>
  <li>í•˜ì§€ë§Œ Softmax LossëŠ” ì •ë‹µ ìŠ¤ì½”ì–´ê°€ ì¶©ë¶„íˆ ë†’ê³  ë‹¤ë¥¸ í´ë˜ìŠ¤ ìŠ¤ì½”ì–´ê°€ ì¶©ë¶„íˆ ë‚®ì€ ìƒíƒœì—ì„œë„ ìµœëŒ€í•œ ì •ë‹µ í´ë˜ìŠ¤ì— í™•ë¥ ì„ ëª°ì•„ ë„£ìœ¼ë ¤ê³ (ì–¸ì œë‚˜ í™•ë¥ ì„ 1ë¡œ ë§Œë“¦) ë…¸ë ¥í•˜ê¸° ë•Œë¬¸ì— ì •ë‹µ í´ë˜ìŠ¤ëŠ” ì–‘ì˜ ë¬´í•œëŒ€ë¡œ, ê·¸ì™¸ ê¸€ë˜ìŠ¤ëŠ” ìŒì˜ ë¬´í•œëŒ€ë¡œ ë³´ë‚´ë ¤ê³  ë…¸ë ¥í•¨</li>
  <li>SVMì˜ ê²½ìš° ì¼ì • marginì„ ë„˜ê¸°ë©´ ë”ì´ìƒ ì„±ëŠ¥ê°œì„ ì— ì‹ ê²½ì“°ì§€ ì•Šì§€ë§Œ, Softmaxì˜ ê²½ìš° ê³„ì†í•´ì„œ ì„±ëŠ¥ì„ ê°œì„ í•´ë‚˜ê°</li>
</ul>

<h2 id="optimization">Optimization</h2>

<p>ì–´ë–»ê²Œ í•´ì•¼ ì‹¤ì œ Lossë¥¼ ì¤„ì´ëŠ” $W$ë¥¼ ì°¾ì„ ìˆ˜ ìˆì„ì§€ë¥¼ ê³ ë¯¼í•˜ëŠ” ê²ƒì´ <strong>ìµœì í™”</strong></p>

<h3 id="strategy-1--random-searchì„ì˜-íƒìƒ‰">Strategy #1 : Random Search(ì„ì˜ íƒìƒ‰)</h3>

<p>ì„ì˜ë¡œ ìƒ˜í”Œë§í•œ $W$ë¥¼ ë§ì´ ëª¨ì•„ë‘ê³  Lossë¥¼ ê³„ì‚°í•´ì„œ ì–´ë–¤ $W$ê°€ ì¢‹ì€ì§€ ì‚´í´ë³´ëŠ” ê²ƒ â†’ ì•„ì£¼ ì•ˆ ì¢‹ì€ ë°©ë²•</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># assume X_train is the data where each column is an example (e.g. 3073 x 50,000)
# assume Y_train are the labels (e.g. 1D array of 50,000)
# assume the function L evaluates the loss function
</span>
<span class="n">bestloss</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="s">"inf"</span><span class="p">)</span> <span class="c1"># Python assigns the highest possible float value
</span><span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
  <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3073</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.0001</span> <span class="c1"># generate random parameters
</span>  <span class="n">loss</span> <span class="o">=</span> <span class="nc">L</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span> <span class="c1"># get the loss over the entire training set
</span>  <span class="k">if</span> <span class="n">loss</span> <span class="o">&lt;</span> <span class="n">bestloss</span><span class="p">:</span> <span class="c1"># keep track of the best solution
</span>    <span class="n">bestloss</span> <span class="o">=</span> <span class="n">loss</span>
    <span class="n">bestW</span> <span class="o">=</span> <span class="n">W</span>
  <span class="k">print</span> <span class="s">'in attempt %d the loss was %f, best %f'</span> <span class="o">%</span> <span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">bestloss</span><span class="p">)</span>

<span class="c1"># prints:
# in attempt 0 the loss was 9.401632, best 9.401632
# in attempt 1 the loss was 8.959668, best 8.959668
# in attempt 2 the loss was 9.044034, best 8.959668
# in attempt 3 the loss was 9.278948, best 8.959668
# in attempt 4 the loss was 8.857370, best 8.857370
# in attempt 5 the loss was 8.943151, best 8.857370
# in attempt 6 the loss was 8.605604, best 8.605604
# ... (trunctated: continues for 1000 lines)
</span>
<span class="c1"># Assume X_test is [3073 x 10000], Y_test [10000 x 1]
</span><span class="n">scores</span> <span class="o">=</span> <span class="n">Wbest</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">Xte_cols</span><span class="p">)</span> <span class="c1"># 10 x 10000, the class scores for all test examples
# find the index with max score in each column (the predicted class)
</span><span class="n">Yte_predict</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># and calculate accuracy (fraction of predictions that are correct)
</span><span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">Yte_predict</span> <span class="o">==</span> <span class="n">Yte</span><span class="p">)</span>
<span class="c1"># returns 0.1555
</span></code></pre></div></div>

<p>â†’ CIFAR-10ì—ì„œ í´ë˜ìŠ¤ëŠ” 10ê°œ ì´ë¯€ë¡œ ì„ì˜ í™•ë¥ ì€ 10%ê°€ ë˜ê³  ë¬´ì‘ìœ„ ì‹œí–‰ì„ ê±°ì¹˜ê²Œ ë˜ë©´ ì´ ì˜ˆì‹œì—ì„œëŠ” 15%ì •ë„ì˜ ì •í™•ë„ë¥¼ ë³´ì„ <br /></p>

<h3 id="strategy-2--follow-the-slope">Strategy #2 : Follow the slope</h3>

<p>ê³¨ìê¸°ì—ì„œ ë•…ì˜ ê²½ì‚¬(Slope)ë¥¼ ëŠë¼ë©´ì„œ ì–´ëŠ ë°©í–¥ìœ¼ë¡œ ë‚´ë ¤ê°€ì•¼ ì‚° ì•„ë˜ë¡œ ë„ì°©í•˜ëŠ”ì§€ ì¡°ê¸ˆì”© ê±¸ì–´ ë‚´ë ¤ê°€ëŠ” ë°©ë²•<br /></p>

<p><strong>Slope(ê²½ì‚¬)</strong></p>

\[\frac{df(x)}{dx}=\lim_{h \rightarrow 0}\frac{f(x+h)-f(x)}{h}\]

<p>1ì°¨ì› ê³µê°„ì—ì„œì˜ slopeëŠ” ì–´ë–¤ í•¨ìˆ˜ì— ëŒ€í•œ ë¯¸ë¶„ ê°’ì„ ì˜ë¯¸í•˜ì§€ë§Œ $x$ëŠ” ìŠ¤ì¹¼ë¼ê°€ ì•„ë‹ˆë¼ ë²¡í„°ì´ê¸° ë•Œë¬¸ì— ë‹¤ë³€ìˆ˜í•¨ìˆ˜ë¡œ í™•ì¥ì‹œì¼œì•¼ í•¨</p>

<p><img width="60%" alt="L3_09" src="https://user-images.githubusercontent.com/86525868/171177146-fa2e0f7b-3420-446e-a302-9ef940b3c534.png" height="60%" class="align-center" /> <br /></p>

<p>Current $W$ì— ì•„ì£¼ ì‘ì€ ê°’ì¸ $h$ë¥¼ ë”í•˜ê³  ë‹¤ì‹œ Lossë¥¼ êµ¬í•˜ë©´ $1.25347$ì—ì„œ $1.25322$ë¡œ ê°ì†Œí•˜ê³  ê·¹í•œì‹ì„ ì´ìš©í•´ì„œ FDMìœ¼ë¡œ ê·¼ì‚¬ì‹œí‚¨ gradientë¥¼ êµ¬í•¨ â†’ ì´ ê³¼ì •ì„ ë°˜ë³µ</p>

<ul>
  <li>í•˜ì§€ë§Œ ì´ ë°©ë²•ì€ ë§ì€ ì‹œê°„ì´ ê±¸ë¦¬ê¸° ë•Œë¬¸ì— ì‚¬ìš©í•˜ì§€ ì•ŠìŒ</li>
</ul>

<p><strong>The loss is just a function of $W$</strong></p>

\[\begin{align}
&amp;L=\frac{1}{N}\sum_{i=1}^N L_i+\sum_k W_k^2\\
&amp;L_i=\sum_{j \ne y_i}max(0, s_j-s_i+1)\\
&amp;s=f(x;W)=Wx\\ \\ 
&amp;\text{want}\ \nabla_W L
\end{align}\]

<p><img width="60%" alt="L3_10" src="https://user-images.githubusercontent.com/86525868/171177165-40f232b6-9e99-44df-b332-f9db80e68b64.png" height="60%" class="align-center" /></p>

<p><br /></p>

<p>$W$ì˜ ëª¨ë“  ì›ì†Œë¥¼ ìˆœíšŒí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ gradientë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì‹ì´ ë¬´ì—‡ì¸ì§€ ë¨¼ì € ì°¾ì•„ë‚´ê³  ìˆ˜ì‹ìœ¼ë¡œ í•œë²ˆì— gradient $dW$ë¥¼ í•œë²ˆì— ê³„ì‚°</p>

<p>ì•ì—ì„œ ë‹¤ë£¬ ìˆ˜ì¹˜ì ì¸ gradientëŠ” ì‹¤ì œë¡œëŠ” ì‚¬ìš©í•˜ì§€ ì•Šì§€ë§Œ ë””ë²„ê¹… íˆ´ë¡œëŠ” ìœ ìš©í•  ìˆ˜ ìˆìŒ (í•˜ì§€ë§Œ ìˆ˜ì¹˜ì  gradientëŠ” ëŠë¦¬ê³  ë¶€ì •í™•í•˜ê¸° ë•Œë¬¸ì— ë””ë²„ê¹…ì— ì´ìš©í•  ë•ŒëŠ” íŒŒë¼ë¯¸í„°ì˜ ìŠ¤ì¼€ì¼ì„ ì¤„ì—¬ì•¼ í•¨)</p>

<h3 id="gradient-descent">Gradient Descent</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Vanilla Gradient Descent
</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
  <span class="n">weights_grad</span> <span class="o">=</span> <span class="nf">evaluate_gradient</span><span class="p">(</span><span class="n">loss_fun</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
  <span class="n">weights</span> <span class="o">+=</span> <span class="o">-</span> <span class="n">step_size</span> <span class="o">*</span> <span class="n">weights_grad</span> <span class="c1"># perform parameter update
</span></code></pre></div></div>

<p>Lossì™€ gradientë¥¼ ê³„ì‚°í•œ ë’¤ì— $W$ë¥¼ gradient ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">step_size</code> = Learning rateë¥¼ ì¡°ì ˆí•˜ë©° ìµœì í™” ì‹œí‚¤ëŠ” ë°©ë²•</p>

<p><img src="https://user-images.githubusercontent.com/86525868/171177171-0b38f906-d7cb-472d-9986-049336342983.png" alt="L3_11" /></p>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> íƒœê·¸: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#cs231" class="page__taxonomy-item" rel="tag">cs231</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#image-classification" class="page__taxonomy-item" rel="tag">image classification</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> ì¹´í…Œê³ ë¦¬: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#cs231n" class="page__taxonomy-item" rel="tag">cs231n</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> ì—…ë°ì´íŠ¸:</strong> <time datetime="2022-05-30T00:00:00+09:00">May 30, 2022</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">ê³µìœ í•˜ê¸°</h4>
  

  <a href="https://twitter.com/intent/tweet?text=%5BCS231N%5D+3.+Loss+Functions+and+Optimization%20http%3A%2F%2Flocalhost%3A4000%2Fcs231n%2Fcs231n-02%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="ê³µìœ í•˜ê¸° Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fcs231n%2Fcs231n-02%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="ê³µìœ í•˜ê¸° Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fcs231n%2Fcs231n-02%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="ê³µìœ í•˜ê¸° LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/cs231n/cs231n-01/" class="pagination--pager" title="[CS231N] 2. Image Classification
">ì´ì „</a>
    
    
      <a href="/cs231n/cs231n-03/" class="pagination--pager" title="[CS231N] 4. Intruduction to Neural Networks
">ë‹¤ìŒ</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">ì°¸ê³ </h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2023-04-20-porti-kaggle/" rel="permalink">
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          11 ë¶„ ì†Œìš”
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/hackerrank/sql-codingtest-1/" rel="permalink">[SQL Hackerrank] Easy
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 ë¶„ ì†Œìš”
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ds/ensemble-3/" rel="permalink">[Data Science] ì•™ìƒë¸”(Ensemble) 3. XGBoost, LightGBM
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 ë¶„ ì†Œìš”
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Ensemble
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ds/ensemble-2/" rel="permalink">[Data Science] ì•™ìƒë¸”(Ensemble) 2. AdaBoost, GBM
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 ë¶„ ì†Œìš”
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Ensemble
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>íŒ”ë¡œìš°:</strong></li>
    

    
      
        
          <li><a href="mailto:96seoyun@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
        
      
        
      
        
      
        
          <li><a href="https://github.com/seoyun2" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
          <li><a href="https://www.instagram.com/seoyun._2/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> í”¼ë“œ</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 ì´ì„œìœ¤(Seoyun Lee). Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>







    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/cs231n/cs231n-02/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/cs231n/cs231n-02"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://seoyun2.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  




<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
  inlineMath: [ ['$','$'], ["\\(","\\)"] ],
  displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
  processEscapes: true
  },
  "HTML-CSS": { availableFonts: ["TeX"] }
});
</script>


  </body>
</html>
